# Предсказание стартапов

## Описание проекта

Главная задача - разработать модель для предсказания успешности стартапа (закроется или нет).

Работа будет проводится с псевдо-реальными (реальные данные в которые добавлена синтетическая составляющая) данными о стартапах, функционировавших в период с 1970 по 2018 годы.

Выделены следующие этапы работы:

- загрузка и ознакомление с данными,
- предварительная обработка,
- полноценный разведочный анализ,
- разработка новых синтетических признаков,
- проверка на мультиколлинеарность,
- отбор финального набора обучающих признаков,
- выбор и обучение моделей,
- итоговая оценка качества предсказания лучшей модели,
- анализ важности ее признаков,
- подготовка отчета по исследованию.

## Загрузка данных

### Тренировочный датасет

Создан тренировочный датафрейм (`startups_train`), содержащий в себе данные о стартапах, которые будут использоваться в качестве обучающих данных. Он имеет 13 столбцов и 52 516 строк. При этом столбцы имеют следующий характер:

- `name` — название стартапа. Имеет тип `object` и 52 515 уникальных значений;
- `category_list` — список категорий, к которым относится стартап. Имеет тип `object` и 22 105 уникальных значений. При этом наиболее часто встречающиеся значение `Software` (встречается 3 207 раз);
- `funding_total_usd` — общая сумма финансирования в USD. Имеет тип `float64`, а значения распределены примерно от 1 до 30 079 500 000 USD. При этом среднее значение составляет примерно 18 247 480 USD, а медиана — 2 000 000 USD;
- `status` — статус стартапа (закрыт или действующий). Имеет тип `object` и 2 уникальных значения. При этом наиболее часто встречающиеся значение `operating` (встречается 47 599 раз);
- `country_code` — код страны. Имеет тип `object` и 134 уникальных значений. При этом наиболее часто встречающиеся значение `USA` (встречается 29 702 раза);
- `state_code` — код штата. Имеет тип `object` и 300 уникальных значений. При этом наиболее часто встречающиеся значение `CA` (встречается 10 219 раз);
- `region` — регион. Имеет тип `object` и 1 036 уникальных значений. При этом наиболее часто встречающиеся значение `SF Bay Area` (встречается 6 970 раз);
- `city` — город. Имеет тип `object` и 4 477 уникальных значений. При этом наиболее часто встречающиеся значение `San Francisco` (встречается 2 824 раза);
- `funding_rounds` — количество раундов финансирования. Имеет тип `int64`, а значения распределены от 1 до 19 раундов. При этом среднее значение составляет примерно 1.74, а медиана — 1;
- `founded_at` — дата основания. Имеет тип `object` и 5 402 уникальных значения. При этом наиболее часто встречающиеся значение `2012-01-01` (встречается 2 171 раз);
- `first_funding_at` — дата первого раунда финансирования. Имеет тип `object` и 4 603 уникальных значения. При этом наиболее часто встречающиеся значение `2013-01-01` (встречается 450 раз);
- `last_funding_at` — дата последнего раунда финансирования. Имеет тип `object` и 4 305 уникальных значений. При этом наиболее часто встречающиеся значение `2014-01-01` (встречается 369 раз);
- `closed_at` — дата закрытия стартапа (если применимо). Имеет тип `object` и 3 008 уникальных значений. При этом наиболее часто встречающиеся значение `2016-12-02` (встречается 8 раз).

### Тестовый датасет

Создан тестовый датафрейм (`startups_test`), содержащий в себе данные о стартапах, которые будут использоваться в качестве тестовых данных. Он имеет 11 столбцов и 13 125 строк. При этом столбцы имеют следующий характер:

- `name` — название стартапа. Имеет тип `object` и 13 125 уникальных значений;
- `category_list` — список категорий, к которым относится стартап. Имеет тип `object` и 6 206 уникальных значений. При этом наиболее часто встречающиеся значение `Software` (встречается 775 раз);
- `funding_total_usd` — общая сумма финансирования в USD. Имеет тип `float64`, а значения распределены примерно от 1 до 4 715 000 000 USD. При этом среднее значение составляет примерно 16 549 100 USD, а медиана — 2 000 000 USD;
- `country_code` — код страны. Имеет тип `object` и 96 уникальных значений. При этом наиболее часто встречающиеся значение `USA` (встречается 7 428 раз);
- `state_code` — код штата. Имеет тип `object` и 235 уникальных значений. При этом наиболее часто встречающиеся значение `CA` (встречается 2 552 раза);
- `region` — регион. Имеет тип `object` и 688 уникальных значений. При этом наиболее часто встречающиеся значение `SF Bay Area` (встречается 1 750 раз);
- `city` — город. Имеет тип `object` и 2 117 уникальных значений. При этом наиболее часто встречающиеся значение `San Francisco` (встречается 656 раз);
- `funding_rounds` — количество раундов финансирования. Имеет тип `int64`, а значения распределены от 1 до 15 раундов. При этом среднее значение составляет примерно 1.71, а медиана — 1;
- `first_funding_at` — дата первого раунда финансирования. Имеет тип `object` и 3 299 уникальных значений. При этом наиболее часто встречающиеся значение `2014-01-01` (встречается 126 раз);
- `last_funding_at` — дата последнего раунда финансирования. Имеет тип `object` и 3 021 уникальных значения. При этом наиболее часто встречающиеся значение `2014-01-01` (встречается 111 раз);
- `lifetime` — время существования стартапа в днях. Имеет тип `int64`, а значения распределены от 52 до 17 167 дней. При этом среднее значение составляет примерно 3097.61, а медиана — 2 526.

## Предобработка данных

### Проверка типов данных

В тренировочном датафрейме столбцы `founded_at`, `first_funding_at`, `last_funding_at`, `closed_at` были переведены из `object` в тип даты и времени (`datetime64[ns]`). Также столбцы `category_list`, `status`, `country_code`, `state_code`, `region`, `city` были переведены из `object` в категориальный тип данных (`category`). Остальные же столбцы имеют корректные типы данных.

В тестовом датафрейме столбцы `first_funding_at`, `last_funding_at` были переведены из `object` в тип даты и времени (`datetime64[ns]`). Также столбцы `category_list`, `country_code`, `state_code`, `region`, `city` были переведены из `object` в категориальный тип данных (`category`). Остальные же столбцы имеют корректные типы данных.

### Изучение пропущенных значений

В тренировочном датафрейме числовой столбец `funding_total_usd` содержал 10 069 пропущенных значений, которые в последующем были заполнены медианным значением. А в столбцах `name` (1 пропуск), `category_list` (2 465 пропусков), `country_code` (5 502 пропуска), `state_code` (6 763 пропуска), `region` (6 359 пропусков), `city` (6 359 пропусков) пропущенные значения были заполнены значением `unknown` (неизвестно). Также последний столбец (`closed_at`) был удален, так как в нем было слишком много пропущенных значений (иначе говоря, он не нес никакой полезной информации для дальнейшего анализа).

В тестовом датафрейме числовой столбец `funding_total_usd` содержал 2 578 пропущенных значений, которые в последующем были заполнены медианным значением из тренировочной выборки. А в столбцах `category_list` (591 пропуск), `country_code` (1 382 пропуска), `state_code` (1 695 пропусков), `region` (1 589 пропусков), `city` (1 587 пропусков) пропущенные значения были заполнены значением `unknown` (неизвестно).

### Изучение дубликатов

В тренировочном датафрейме было произведено укрупнение категорий (`category_list`) с 22 106 до 1 394 уникальных значений. А в столбцах `country_code` и `state_code` были замечены некорректные значения аббревиатур (40 неправильных кодов стран, 16 301 неправильных кодов штатов), которые в последующем были заменены на значение `unknown` (неизвестно). Также было удалено 24 явных дубликатов по всем столбцам, кроме `name`.

В тестовом датафрейме было произведено укрупнение категорий (`category_list`) с 6 207 до 666 уникальных значений. А в столбцах `country_code` и `state_code` были замечены некорректные значения аббревиатур (6 неправильных кодов стран, 4 060 неправильных кодов штатов), которые в последующем были заменены на значение `unknown` (неизвестно). Также было выявлено 59 явных дубликатов по всем столбцам, кроме `name`, но они не были удалены, поскольку нельзя вносить какие-либо координальные изменения в тестовую выборку.

### Изучение аномальных значений

В столбце `funding_total_usd` тренировочного датафрейма было удалено 55 аномалий, поскольку они имели слишком большие (больше 5 млрд. долларов) и малые значения (меньше 1 000 долларов).

В столбце `funding_total_usd` тестового датафрейма тоже наблюдаются аномально низкие значения, но они не были удалены, поскольку нельзя вносить какие-либо координальные изменения в тестовую выборку.

### Удаление неинформативных признаков

В тренировочном датафрейме была удалена дата основания стартапа (`founded_at`), так как такого признака нет в тестовой выборке. Также в тестовом датафрейме было удалено время существования стартапа в днях (`lifetime`), поскольку такого признака нет в тренировочной выборке, а воссоздать его не представляется возможным.

## Исследовательский анализ данных

### Распределение категорий стартапов

В тренировочной выборке большая часть стартапов имеет категорию `IT`, их доля составляет 17.67% (8 561 действующих, 701 закрытых). На втором месте находится категория `Medicine` с долей в 11.65% (5 770 действующих, 343 закрытых), на третьем — `Media` c долей в 8.47% (3 810 действующих, 629 закрытых), на четвертом — `Other` с долей в 5.46% (2 675 действующих, 188 закрытых), на пятом — `unknown` с долей в 4.67% (1 727 действующих, 726 закрытых).

В тестовой выборке большая часть стартапов имеет категорию `IT`, их доля составляет 17.45% (2 290 стартапов). На втором месте находится категория `Medicine` с долей в 11.49% (1 508 стартапов), на третьем — `Media` c долей в 8.25% (1 083 стартапа), на четвертом — `Other` с долей в 5.61% (736 стартапов), на пятом — `unknown` с долей в 4.5% (591 стартап).

### Распределение общих сумм финансирования стартапов

Распределение общих сумм финансирования стартапов в тренировочной выборке имеет сильную правостороннюю асимметрию, при этом пик у действующих стартапов находится в диапазоне значений 1-3 млн. долларов (16 034 стартапов), а у закрывшихся — 0.001-1 млн. долларов (1 716 стартапов). Также у обоих распределений минимальные значения совпадают (в значении 1 тыс. долларов), а максимальные расходятся (у действующих стартапов — примерно 4.812 млрд. долларов, а у закрывшихся — 1.567 млрд. долларов). В предоставленных данных, обе группы стартапов имеют одинаковые общие суммы финансирования, так как их меиданы совпадают в значении 2 млн. долларов. При этом межквартильный размах у действующих стартапов шире (примерно на 1.81 млн. долларов), что указывает на более широкое распределение данных. Также у действующих стартапов наблюдается 15.06% выбросов (в значениях больше 16.648 млн. долларов), а у закрывшихся — 14.73% (в значениях больше 11.885 млн. долларов).

Распределение общих сумм финансирования стартапов в тестовой выборке имеет сильную правостороннюю асимметрию, при этом пик находится в диапазоне значений от 1 доллара до 2.5 млн. долларов (8 245 стартапов). Также минимальное значение составляет 1 доллар, а максимальное — 4.715 млрд. долларов. Межквартильный размах составляет примерно 6.013 млн. долларов. Обнаружено 14.83% выбросов (в значениях больше 15.5 млн. долларов).

### Распределение географических местоположений стартапов

В тренировочной выборке большая часть стартапов расположена в `USA` в наиболее популярном регионе `SF Bay Area` (города: `San Francisco` — 4.89% действующих и 0.49% закрывшихся стартапов, `Palo Alto` — 1.03% действующих и 0.12% закрывшихся стартапов, `Mountain View` — 0.84% действующих и 0.05% закрывшихся стартапов), при этом наиболее популярные штаты: `unknown` (38.87% действующих и 5.04% закрывшихся стартапов), `CA` (17.69% действующих и 1.78% закрывшихся стартапов), `NY` (5.47% действующих и 0.46% закрывшихся стартапов). На втором месте расположились неизвестные страны с неизвестными регионами и городами (8.01% действующих и 2.44% закрывшихся стартапов). На третьем — `GBR` с наиболее популярным регионом `London` (города: `London` — 2.67% действующих и 0.2% закрывшихся стартапов, `Cambridge` — 0.18% действующих и 0.01% закрывшихся стартапов, `Oxford` — 0.06% действующих и 0.002% закрывшихся стартапов). На четвертом — `CAN` с наиболее популярным регионом `Toronto` (города: `Toronto` — 0.73% действующих и 0.08% закрывшихся стартапов, `Waterloo` — 0.06% действующих и 0.01% закрывшихся стартапов, `Kitchener` — 0.05% действующих и 0.002% закрывшихся стартапов). На пятом — `FRA` с наиболее популярным регионом `Paris` (города: `Paris` — 0.84% действующих и 0.08% закрывшихся стартапов, `Boulogne-Billancourt` — 0.03% действующих и 0.002% закрывшихся стартапов, `Courbevoie` — 0.01% действующих и 0% закрывшихся стартапов).

В тестовой выборке большая часть стартапов расположена в `USA` в наиболее популярном регионе `SF Bay Area` (города: `San Francisco` — 5% стартапов, `Palo Alto` — 1.18% стартапов, `Mountain View` — 0.99% стартапов), при этом наиболее популярные штаты: `unknown` (43.85% стартапов), `CA` (19.44% стартапов), `NY` (6.01% стартапов). На втором месте расположились неизвестные страны с неизвестными регионами и городами (10.54% стартапов). На третьем — `GBR` с наиболее популярным регионом `London` (города: `London` — 2.91% стартапов, `Cambridge` — 0.22% стартапов, `Oxford` — 0.06% стартапов). На четвертом — `CAN` с наиболее популярным регионом `Toronto` (города: `Toronto` — 0.72% стартапов, `Waterloo` — 0.11% стартапов, `Kitchener` — 0.08% стартапов). На пятом — `DEU` с наиболее популярным регионом `Berlin` (города: `Berlin` — 0.36% стартапов, `Potsdam` — 0.03% стартапов, `Berlin-Baumschulenweg` — 0.01% стартапов).

### Распределение дат первого раунда финансирования стартапов

Распределение дат первого раунда финансирования стартапов в тренировочной выборке имеет сильную левостороннюю асимметрию, при этом пик у действующих стартапов находится в диапазоне значений с января по февраль 2014 года (1 746 стартапов), а у закрывшихся — с мая по инюнь 2015 года (172 стартапа). Также у обоих распределений минимальные (у действующих стартапов — `1977-05-15`, у закрывшихся стартапов — `1982-03-20`) и максимальные (у действующих стартапов — `2015-12-05`, у закрывшихся стартапов — `2015-12-04`) значения не совпадают. В предоставленных данных, обе группы стартапов имеют разные даты первого раунда финансирования, так как их меиданы не совпадают (у действующих стартапов — `2012-09-13 12:00:00`, у закрывшихся стартапов — `2010-08-10`). При этом межквартильный размах у закрывшихся стартапов шире (на 566 дней), что указывает на более широкое распределение данных. Также у действующих стартапов наблюдается 3.58% выбросов (в значениях до августа 2003), а у закрывшихся — 0.94% (в значениях до января 1999).

Распределение дат первого раунда финансирования стартапов в тестовой выборке имеет сильную правостороннюю асимметрию, при этом пик находится в диапазоне значений с января по февраль 2014 года (469 стартапов). Также минимальным значением является `1973-04-15`, а максимальным — `2015-12-03`. Межквартильный размах составляет 1 597 дней. Обнаружено 3.75% выбросов (в значениях до апреля 2003).

### Распределение дат последнего раунда финансирования стартапов

Распределение дат последнего раунда финансирования стартапов в тренировочной выборке имеет сильную левостороннюю асимметрию, при этом пик у действующих стартапов находится в диапазоне значений с марта по апрель 2015 года (2 203 стартапа), а у закрывшихся — с мая по инюнь 2015 года (188 стартапов). Также у обоих распределений минимальные (у действующих стартапов — `1977-05-15`, у закрывшихся стартапов — `1982-03-20`) и максимальные (у действующих стартапов — `2015-12-07`, у закрывшихся стартапов — `2015-12-04`) значения не совпадают. В предоставленных данных, обе группы стартапов имеют разные даты последнего раунда финансирования, так как их меиданы не совпадают (у действующих стартапов — `2013-10-15`, у закрывшихся стартапов — `2011-04-01`). При этом межквартильный размах у закрывшихся стартапов шире (на 773 дня), что указывает на более широкое распределение данных. Также у действующих стартапов наблюдается 5.03% выбросов (в значениях до марта 2006), а у закрывшихся — 0.94% (в значениях до ноября 1999).

Распределение дат последнего раунда финансирования стартапов в тестовой выборке имеет сильную правостороннюю асимметрию, при этом пик находится в диапазоне значений с марта по апрель 2015 года (575 стартапов). Также минимальным значением является `1973-04-15`, а максимальным — `2015-12-12`. Межквартильный размах составляет 1 401 день. Обнаружено 4.36% выбросов (в значениях до апреля 2005).

### Распределение статусов стартапов в тренировочной выборке

В тренировочной выборке наблюдается огромный дисбаланс категорий целевого признака `status` в сторону действующих стартапов, имеющих долю примерно в 90.6% (47 528 стартапов). При этом доля у закрывшихся стартапов составляет 9.4% (4 909 стартапов).

## Разработка новых синтатических признаков

### Преобразование дат в числовой формат

В тренировочной и тестовой выборках все даты были переведены в числовой формат (секунды от эпохи Unix).

### Получение координат городов стартапов

В тренировочной и тестовой выборках созданы новые признаки, отображающие координаты городов (`latitude` — широта, `longitude` — долгота), в которых находятся стартапы. Причем их типы данных были переведны из `float64` в `float32` для экономии вычислительной памяти, а также заполнены пропущенные значения координатами `0.0`.

### Векторизация категорий стартапов

В тренировочной и тестовой выборках была проведена векторизация категорий с помощью TF-IDF (максимальное кол-во признаков 100) и PCA (сокращение до 10 признаков).

## Проверка на мультиколлинеарность

С помощью коэффициента VIF была выявлена мультиколлинеарность между `first_funding_at` (1208.433) и `last_funding_at` (1325.853), так как это может сказаться на итоговом качестве модели, то было решено создать новый признак на основе дат первого и последнего раундов финансирования, а именно вычислить длительность финансирования.

## Построение моделей машинного обучения

### Создание выборок

В качестве целевого признака был выбран статус стартапов (`status`), а в качестве входных: общая сумма финансирования (`funding_total_usd`), кол-во раундов финансирования (`funding_rounds`), длительность финансирования (`funding_duration`), широта (`latitude`), долгота (`longitude`), PCA-признаки (`category_pca_0`, `category_pca_1`, `category_pca_2`, `category_pca_3`, `category_pca_4`, `category_pca_5`, `category_pca_6`, `category_pca_7`, `category_pca_8`, `category_pca_9`).

Для дальнейшего обучения моделей было произведено кодирование (`label encoder`) целевого признака: закрывшийся стартап обозначается как `0` (`closed`), а действующий — как `1` (`operating`).

Так как в обучающей выборке наблюдался огромный дисбаланс категорий целевого признака, то было решено его устранить с помощью метода `SMOTE` (кол-во соседей — 5). В валидационной же выборке дисбаланс сохранился для приближения к реальным данным.

В итоге, получились следующие выборки:

- тренировочная выборка: входные признаки имеют 71 290 строк и 15 столбцов (`X_train`), а целевой — 71 290 строк (`y_train`);
- валидационная выборка: входные признаки имеют 13 110 строк и 15 столбцов (`X_val`), а целевой — 13 110 строк (`y_val`);
- тестовая выборка: входные признаки имеют 13 125 строк и 15 столбцов (`X_test`).

### Подбор моеделй и их гиперпараметров

Для подготовки данных простым моделям были выбраны следующие методы масштабирования: `StandardScaler`, `MinMaxScaler` и `RobustScaler`.

Для задачи классификации было выбрано 6 простых моделей машинного обучения:

- логистическая регрессия с L1-регуляризацией и гиперпараметрами: обратный коэффициент регуляризации от 0.001 до 100 (больше `C` → слабее регуляризация), алгоритм оптимизации `liblinear` (`solver`);
- логистическая регрессия с L2-регуляризацией и гиперпараметрами: обратный коэффициент регуляризации от 0.001 до 100 (больше `C` → слабее регуляризация), алгоритм оптимизации `liblinear` (`solver`);
- метод опорных векторов с гиперпараметрами: обратный коэффициент регуляризации от 0.001 до 100 (больше `C` → слабее регуляризация);
- k-ближайших соседей с гиперпараметрами: кол-во соседей от 1 до 30 (`n_neighbors`), равные (`uniform`) и обратные (`distance`) веса (`weights`);
- дерево решений с гиперпараметрами: максимальная глубина дерева от 2 до 20 (`max_depth`), минимальное кол-во объектов в узле от 2 до 20 (`min_samples_split`), минимальное кол-во объектов в листе от 1 до 10 (`min_samples_leaf`);
- случайный лес с гиперпараметрами: кол-во деревьев от 50 до 500 (`n_estimators`), максимальная глубина дерева от 2 до 20 (`max_depth`), минимальное кол-во объектов в узле от 2 до 20 (`min_samples_split`), минимальное кол-во объектов в листе от 1 до 10 (`min_samples_leaf`).

Для градиентного бустинга `LightGBM` будут использоваться следующие гиперпараметры:

- оптимизация для бинарной классификации (`objective`);
- максимальное кол-во листьев в дереве: от 10 до 80 (`num_leaves`);
- минимальное кол-во объектов в листе: от 5 до 50 (`min_child_samples`);
- максимальная глубина дерева: от 3 до 10 (`max_depth`);
- кол-во деревьев: от 100 до 300 (`n_estimators`);
- шаг градиентного спуска: от 0.01 до 0.1 (`learning_rate`);
- L1-регуляризация: от 0.001 до 0.1 (`reg_alpha`);
- L2-регуляризация: от 0.001 до 0.1 (`reg_lambda`)
- оптимизация GPU (`task_type`).

Для градиентного бустинга `CatBoost` будут использоваться следующие гиперпараметры:

- максимальная глубина дерева: от 3 до 10 (`depth`);
- кол-во деревьев: от 100 до 300 (`iterations`);
- шаг градиентного спуска: от 0.01 до 0.1 (`learning_rate`);
- L2-регуляризация: от 0.001 до 0.1 (`l2_leaf_reg`);
- быстрый бутстреп `Bernoulli` (`bootstrap_type`);
- 50-90% данных в каждом дереве (`subsample`);
- упрощенная дискретизация: от 32 до 128 (`border_count`);
- быстрое построение деревьев с помощью алгоритма `Lossguide` (`grow_policy`);
- остановка обучения, если нет улучшения за 50 итераций (`early_stopping_rounds`)
- оптимизация GPU (`task_type`).

### Обучение и валидация

Кросс-валидация с помощью `Optuna` показала, что среди всех простых моделей лучшей оказался случайный лес со следующими гиперпараметрами:

- предобработка: `MinMaxScaler`;
- кол-во деревьев: 485 (`n_estimators`);
- максимальная глубина дерева: 18 (`max_depth`);
- минимальное кол-во объектов в узле: 15 (`min_samples_split`);
- минимальное кол-во объектов в листе: 7 (`min_samples_leaf`).

Метрика $F1$ лучшего дерева решений на валидационных данных составляет 0.92, при этом время обучения равняется 46.46 сек., а скорость предсказания — 22 807 предск./сек..

Кросс-валидация с помощью `Optuna` показала, что лучшим градиентным бустингом `LightGBM` является модель со следующими гиперпараметрами:

- максимальное кол-во листьев в дереве: 66 (`num_leaves`);
- минимальное кол-во объектов в листе: 15 (`min_child_samples`);
- максимальная глубина дерева: 10 (`max_depth`);
- кол-во деревьев: 231 (`n_estimators`);
- шаг градиентного спуска: 0.01 (`learning_rate`);
- L1-регуляризация: 0.051 (`reg_alpha`);
- L2-регуляризация: 0.001 (`reg_lambda`).

Метрика $F1$ лучшего градиентного бустинга `LightGBM` на валидационных данных составляет 0.93, при этом время обучения равняется 0.54 сек., а скорость предсказания — 336 149 предск./сек..

Кросс-валидация с помощью `Optuna` показала, что лучшим градиентным бустингом `CatBoost` является модель со следующими гиперпараметрами:

- максимальная глубина дерева: 7 (`depth`);
- кол-во деревьев: 291 (`iterations`);
- шаг градиентного спуска: 0.01 (`learning_rate`);
- L2-регуляризация: 0.026 (`l2_leaf_reg`);
- 50% данных в каждом дереве (`subsample`);
- упрощенная дискретизация: 126 (`border_count`).

Метрика $F1$ лучшего градиентного бустинга `CatBoost` на валидационных данных составляет 0.93, при этом время обучения равняется 3.64 сек., а скорость предсказания — 467 444 предск./сек..

### Анализ моделей

Матрица ошибок случайного леса имеет следующий вид:

- 209 закрывшихся стартапов были верно классифицированы (TN),
- 1 018 закрывшихся стартапов были неверно классифицированы (FN),
- 11 099 действующих стартапов были верно классифицированы (TP),
- 784 действующих стартапа были неверно классифицированы (FP).

Доля верных прогнозов на валидационной выборке составляет 86% (accuracy). Точность же, с которой модель присваивает стартапам категорию `operating` составляет 92% (precision). Причем 93% (recall) стартапов категории `operating` модель смогла правильно идентифицировать среди всех стартапов категории `operating`.

Матрица ошибок градиентного бустинга `LightGBM` имеет следующий вид:

- 211 закрывшихся стартапов были верно классифицированы (TN),
- 1 016 закрывшихся стартапов были неверно классифицированы (FN),
- 11 166 действующих стартапов были верно классифицированы (TP),
- 717 действующих стартапов были неверно классифицированы (FP).

Доля верных прогнозов на валидационной выборке составляет 87% (accuracy). Точность же, с которой модель присваивает стартапам категорию `operating` составляет 92% (precision). Причем 94% (recall) стартапов категории `operating` модель смогла правильно идентифицировать среди всех стартапов категории `operating`.

Матрица ошибок градиентного бустинга `CatBoost` имеет следующий вид:

- 222 закрывшихся стартапа были верно классифицированы (TN),
- 1 005 закрывшихся стартапов были неверно классифицированы (FN),
- 11 134 действующих стартапа были верно классифицированы (TP),
- 749 действующих стартапов были неверно классифицированы (FP).

Доля верных прогнозов на валидационной выборке составляет 87% (accuracy). Точность же, с которой модель присваивает стартапам категорию `operating` составляет 92% (precision). Причем 94% (recall) стартапов категории `operating` модель смогла правильно идентифицировать среди всех стартапов категории `operating`.

### Выбор лучшей модели

По итогу, лучшей моделью оказался градиентный бустинг `Catboost`, поскольку у него лучший результат по метрике $F1$ (0.93), recall (94%) и скорости предсказания на валидационных данных, хотя и уступает во времени обучения градиентному бустингу `LightGBM`.

## Анализ важности признаков лучшей модели

С точки зрения лучшей модели и согласно графику важности SHAP в виде плотбара, входные признаки можно разделить на:

- **значимые**: кол-во раундов финансирования (`funding_rounds`);
- **малозначимые**: длительность финансирования (`funding_duration`), категория стартапа (`category_list`);
- **незначимые**: долгота (`longitude`), широта (`latitude`), общая сумма финансирования (`funding_total_usd`).

Согласно графику важности SHAP в виде beeswarm, лучшая модель говорит о том, что низкие значения кол-ва раундов финансирования влияют на определение закрывающихся стартапов.

## Тестирование лучшей модели

Метрика $F1$ на тестовых данных составляет 0.26, что является очень плохим результатом, скорее всего где-то происходит утечка данных. Следует координально пересмотреть подходы к обработке и разработке признаков для машинного обучения.